<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- WooDoo Settings Form View -->
    <record id="res_config_settings_view_form_woodoo" model="ir.ui.view">
        <field name="name">res.config.settings.view.form.inherit.woodoo</field>
        <field name="model">res.config.settings</field>
        <field name="priority" eval="10"/>
        <field name="inherit_id" ref="base.res_config_settings_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//form" position="inside">
                <app data-string="WooDoo" string="WooDoo" name="woodoo" groups="base.group_system">
                    <block title="WooCommerce Connection Settings" name="woodoo_connection">
                        <setting string="WordPress URL" help="Enter your WordPress website URL">
                            <field name="woodoo_wordpress_url" placeholder="https://example.com"/>
                        </setting>

                        <setting string="WooCommerce API Credentials" help="Get these from WooCommerce > Settings > Advanced > REST API">
                            <div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <field name="woodoo_api_consumer_key" placeholder="Consumer Key" password="True"/>
                                    </div>
                                    <div class="col-lg-6">
                                        <field name="woodoo_api_consumer_secret" placeholder="Consumer Secret" password="True"/>
                                    </div>
                                </div>
                            </div>
                        </setting>

                        <setting string="Connection Status" help="Current connection status">
                            <field name="woodoo_connection_status" readonly="1"/>
                            <div class="mt8">
                                <button name="test_woodoo_connection"
                                        string="Test Connection"
                                        type="object"
                                        class="btn-primary"
                                        attrs="{'invisible': [('woodoo_connection_status', '=', 'Not Configured')]}"/>
                            </div>
                        </setting>
                    </block>

                    <block title="Synchronization Settings" name="woodoo_sync_settings">
                        <setting string="Enable Customer Sync" help="Synchronize customers from WooCommerce to Odoo">
                            <field name="woodoo_sync_customers"/>
                        </setting>

                        <setting string="Enable Order Sync" help="Synchronize orders from WooCommerce to Odoo">
                            <field name="woodoo_sync_orders"/>
                        </setting>

                        <setting string="Enable Product Sync" help="Synchronize products between WooCommerce and Odoo">
                            <field name="woodoo_sync_products"/>
                        </setting>

                        <setting string="Auto Sync" help="Enable automatic synchronization">
                            <field name="woodoo_auto_sync"/>
                            <div class="content-group" attrs="{'invisible': [('woodoo_auto_sync', '=', False)]}">
                                <div class="row mt16">
                                    <label string="Sync Interval" for="woodoo_sync_interval" class="col-lg-3 o_light_label"/>
                                    <field name="woodoo_sync_interval"/>
                                </div>
                            </div>
                        </setting>
                    </block>

                    <block title="Sync Status &amp; Control" name="woodoo_sync_status">
                        <setting string="Last Synchronization" help="When was the last sync performed">
                            <field name="woodoo_last_sync" readonly="1"/>
                        </setting>

                        <setting string="Manual Sync" help="Trigger synchronization now">
                            <button name="sync_now_woodoo"
                                    string="Sync Now"
                                    type="object"
                                    class="btn-primary"
                                    attrs="{'invisible': [('woodoo_connection_status', '=', 'Not Configured')]}"/>
                        </setting>
                    </block>
                </app>
            </xpath>
        </field>
    </record>

    <!-- WooDoo Settings Menu -->
    <record id="woodoo_config_settings_action" model="ir.actions.act_window">
        <field name="name">WooDoo Configuration</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">res.config.settings</field>
        <field name="view_mode">form</field>
        <field name="target">inline</field>
        <field name="context">{'module': 'woodoo', 'bin_size': False}</field>
    </record>

    <!-- Server Action for Apps Configure button -->
    <record id="woodoo_config_server_action" model="ir.actions.server">
        <field name="name">Configure WooDoo</field>
        <field name="model_id" ref="base.model_res_config_settings"/>
        <field name="state">code</field>
        <field name="code">
action = env.ref('woodoo.woodoo_config_settings_action').read()[0]
        </field>
    </record>

    <!-- Make the server action available as an ir.actions.act_window -->
    <record id="action_woodoo_config" model="ir.actions.act_window">
        <field name="name">Configure WooDoo</field>
        <field name="res_model">res.config.settings</field>
        <field name="view_mode">form</field>
        <field name="target">inline</field>
        <field name="context">{'module': 'woodoo'}</field>
    </record>
</odoo>
